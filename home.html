<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Take Photo</title>
</head>
<body>
  <video id="video" autoplay></video>
  <button id="take-photo-btn">Take Photo</button>
  <canvas id="canvas"></canvas>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="take-photo.js"></script>
  
  <script language="javascript">
  // Check if the browser supports the camera API
if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  // Get the video element
  var video = document.getElementById('video');
  
  // Request access to the camera
  navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
    // Show the camera feed in the video element
    video.srcObject = stream;
    
    // Take a photo when the user clicks a button
    document.getElementById('take-photo-btn').addEventListener('click', function() {
      var canvas = document.getElementById('canvas');
      var context = canvas.getContext('2d');
      
      // Set the canvas dimensions to match the video dimensions
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      
      // Draw the video frame on the canvas
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      
      // Convert the canvas to an image data URL
      var dataURL = canvas.toDataURL();
      
      // Send the image data URL to the server for processing and email sending
      $.ajax({
        url: 'process-photo.php',
        type: 'POST',
        data: { image: dataURL },
        success: function(response) {
          console.log('Photo sent successfully!');
        },
        error: function(xhr, status, error) {
          console.log('Error sending photo: ' + error);
        }
      });
    });
  });
}
  </script>
  <?php
if(isset($_POST['image'])) {
  $image_data = $_POST['image'];
  
  // Process the image data and send it through email
  // You can use PHPMailer or another library to send emails
  
  // Example email sending code using PHPMailer
  /*
  use PHPMailer\PHPMailer\PHPMailer;
  use PHPMailer\PHPMailer\Exception;

  // Load PHPMailer library
  require 'vendor/autoload.php';

  // Instantiate PHPMailer
  $mail = new PHPMailer(true);

  try {
    // Configure mail settings
    $mail->SMTPDebug = SMTP::DEBUG_SERVER;
    $mail->isSMTP();
    $mail->Host = 'smtp.gmail.com';
    $mail->SMTPAuth = true;
    $mail->Username = 'bluestacku116@gmail.com';
    $mail->Password = 'Prasanth @ 3';
    $mail->SMTPSecure = PHPMailer::ENCRYPTION_STARTTLS;
    $mail->Port = 587;

    // Set mail details
    $mail->setFrom('bluestacku116@gmail.com', 'BlueStack User');
    $mail->addAddress('programmerprasanth@gmail.com', 'Prasanth P');
    $mail->addAttachment($image_data, 'photo.png');

    // Send mail
   ?>

</body>
</html>
